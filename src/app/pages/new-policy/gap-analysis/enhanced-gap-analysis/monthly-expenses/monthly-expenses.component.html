<div class="form">
  <div class="row-1">
    <div class="row-1-column-1">
      <div class="wd-60">
        <div class="section-title pb-3">
          <h4>{{ 'monthly.title' | translate }}</h4>
        </div>

        @if (currentGlobalFormValue.meetingDetailForm?.IsSecondaryApplicant) {
        <p class="body-medium-regular pt-3">
          {{ 'monthly.subTitle' | translate }}
        </p>
        }
      </div>

      <div class="row" [formGroup]="monthlyExpenseForm">
        <div class="col-6">

          <span class="body-medium-bold">{{ 'monthly.newDebt' | translate }}</span>
          <div>
            <mat-form-field appearance="outline" class="w-100">
              <input
                matInput
                currencyMask
                appCurrencyOptions
                [options]="{ precision: 0, thousands: '', prefix: '', align: 'left' }"
                type="text"
                placeholder="{{ 'monthly.newDebt' | translate }}"
                formControlName="NewMonthlyMortgageLoanPayment" />
            </mat-form-field>
          </div>
        </div>

        <div class="col-6">
          <div class="d-flex justify-content-start align-items-center">
            <span class="body-medium-bold min-wid-cls">{{ 'monthly.debt' | translate }}</span>
            <div class="d-flex ms-2" appTooltip
              [tooltip]="{ tooltip: 'monthly.debtTooltip' | translate, position: 'top', style: 'info' }"
              aria-label="details">
              <mat-icon>error_outline</mat-icon>
            </div>
          </div>
          <mat-form-field appearance="outline" class="w-100">
            <input matInput currencyMask appCurrencyOptions
              [options]="{ precision: 0, thousands: '', prefix: '', align: 'left' }" type="text"
              placeholder="{{ 'monthly.debt' | translate }}" formControlName="ExistingMonthlyLiabilityDebtPayments" />
          </mat-form-field>
        </div>

        <div class="col-6 form-field">
          <span class="body-medium-bold">{{ 'monthly.living' | translate }} %</span>
          <div>
            <mat-form-field appearance="outline" class="w-100">
              <input matInput suffix="%" mask="percent" onlyInteger type="text"
                placeholder="{{ 'monthly.living' | translate }} %" formControlName="OtherMonthlyExpensesInPercentage"
                (blur)="convertLivingExpensesPercentageToNumber()" />
            </mat-form-field>
          </div>
        </div>

        <div class="col-6 form-field">
          <span class="body-medium-bold">{{ 'monthly.living' | translate }} $</span>
          <div>
            <mat-form-field appearance="outline" class="w-100">
              <input matInput currencyMask appCurrencyOptions
                [options]="{ precision: 0, thousands: '', prefix: '', align: 'left' }" type="text"
                placeholder="{{ 'monthly.living' | translate }} $" formControlName="OtherMonthlyExpensesInNumber"
                (blur)="convertLivingExpenseNumberToPercentage()" />
            </mat-form-field>
          </div>
        </div>
      </div>
      <div class="securian-card bg-light p-3 mt-3">
        <div class="d-flex justify-content-between">
          <p class="body-medium-bold">{{ 'monthly.income' | translate }}:</p>
          <p class="body-small-bold">
            @if (languageService.languageSelected$ | async; as language) {
            <span class="body-medium-bold">
              {{ getTotalMonthlyIncome() | currencyOption: 'USD' : 'symbol' : '2.0' : language }}
            </span>
            }
          </p>
        </div>
        <div class="d-flex justify-content-between pt-2">
          <p class="body-medium-bold">{{ 'monthly.currentMonthly' | translate }}:</p>
          <p class="body-small-bold">
            @if (languageService.languageSelected$ | async; as language) {
            <span class="body-medium-bold">
              {{ getTotalMonthlyExpenses() | currencyOption: 'USD' : 'symbol' : '2.0' : language }}
            </span>
            }
          </p>
        </div>
        <mat-divider class="mt-3 pb-2"></mat-divider>
        <div class="d-flex justify-content-between pt-2">
          <p class="body-medium-bold">{{ 'monthly.netIncome' | translate }}:</p>
          <p class="body-small-bold" [ngClass]="{
              'error-color': getNetMonthlyIncome() < 0,
              'success-color': getNetMonthlyIncome() > 0,
            }">
            @if (languageService.languageSelected$ | async; as language) {
            <span class="body-medium-bold securian-leaf-text-color">
              {{ getNetMonthlyIncome() | currencyOption: 'USD' : 'symbol' : '2.0' : language }}
            </span>
            }
          </p>
        </div>
      </div>
      <div class="text-end pt-5">
        <div class="button-row">
          <button class="button-secondary" matStepperPrevious>
            {{ 'monthly.back' | translate }}
          </button>
          <button class="button-primary" matStepperNext (click)="saveExpenses()">
            {{ 'monthly.next' | translate }}
          </button>
          @if (isFormInvalid()) {
          <div class="text-center">
            <errorMessage message="{{ 'general.missingMessage' | translate }}"></errorMessage>
          </div>
          }
        </div>
      </div>
    </div>
    <div class="row-1-column-2 me-2">
      <div class="securian-card securian-card-lighter car-bgcolor">
        <div class="ms-3 mb-3">
          <app-info-box title="{{ 'monthly.bestIncome' | translate }}"
            content="{{ 'monthly.mostBorrowers' | translate }}"></app-info-box>
        </div>
      </div>
    </div>
  </div>
</div>